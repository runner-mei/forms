{{ define "main"}}
<div class="form-group{{if .errors}} has-error{{end}}">
  {{if .label}}
  <label
      class="col-lg-{{default .labelWidth 2}} control-label {{ if .labelClasses }}{{range .labelClasses}} {{.}}{{end}}{{end}}"
      {{if .id}} for="{{.id}}" {{end}}>
    {{.label}}
  </label>
  {{end}}
  <div class="col-lg-{{default .controlWidth 9}}">
    <select name="{{.name}}" class="form-control {{ if .classes }}{{range .classes}}{{.}} {{end}}{{end}}"
            {{if .id}} id="{{.id}}" {{end}}{{if .params}}{{range $k, $v :=.params}} {{$k}}="{{$v}}" {{end}}{{end}}
            {{if .css}}
            style="{{range $k, $v := .css}}{{$k}}: {{$v}}; {{end}}"
            {{end}}
            {{range $v :=.tags}} {{$v}}{{end}}>
      {{ $p := .}}
      {{range $k, $v := .choices}}
      {{ if $k }}
        <optgroup label="{{$k}}">{{end}}
      {{range $v}}
        <option value="{{.ID}}"
                {{if strIn "multiple" $p.tags }}
                  {{$id :=.ID}}
                  {{range $k2, $p2 :=$p.multValues}}
                  {{if eq $k2 $id}}selected{{end}}
                  {{end}}
                {{else}}
                  {{ if eq $p.value .ID}} selected{{end}}
                {{end}}>{{raw .Val}}
        </option>
      {{end}}
      {{if $k}}
        </optgroup>
      {{end}}
      {{end}}
    </select>
    {{if or .helptext .errors }}<span class="help-block">{{if .helptext}}{{ .helptext }}{{end}}
    {{if .errors}}<ul>{{ range .errors }}<li>{{.}}</li>{{end}}</ul>{{end}}</span>{{end}}
  </div>
</div>
{{end}}
